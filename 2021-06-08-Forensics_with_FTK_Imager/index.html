<!DOCTYPE html><html class="appearance-dark" lang="en"><head><meta charset="UTF-8"><title>Forensics with FTK Imager</title><meta name="description" content="Infosec Blog"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/img/favicon.png"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="
Image taken from here


In this blog I am going to show the interface of FTK Imager tool and talk about various files of NTFS, a widely used tool in terms of Cyber Forensics, and also why Ilike this tool is because it has so many features and yet it is a free tool. If you don’t have FTK Imager tool then you can download itfrom this link. 

This is the hom.."><meta name="generator" content="Hexo 5.4.0"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">vulnfreak's blog</a></h2></section><h3 class="is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Forensics with FTK Imager</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-Various-files-present-in-NTFS"><span class="toc-text">1.Various files present in NTFS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1Why-is-it-asked"><span class="toc-text">1.1Why is it asked?</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-How-to-see-these-files"><span class="toc-text">2.How to see these files?</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/CHFI"><i class="tag post-item-tag">CHFI</i></a><a href="/tags/CyberForensics"><i class="tag post-item-tag">CyberForensics</i></a><a href="/tags/Cyber"><i class="tag post-item-tag">Cyber</i></a><a href="/tags/Forensics"><i class="tag post-item-tag">Forensics</i></a><a href="/tags/StrorageDevice"><i class="tag post-item-tag">StrorageDevice</i></a><a href="/tags/FTK"><i class="tag post-item-tag">FTK</i></a><a href="/tags/PSTools"><i class="tag post-item-tag">PSTools</i></a><a href="/tags/hex"><i class="tag post-item-tag">hex</i></a></header><h1 class="mt-0 mb-1" id="postTitle">Forensics with FTK Imager</h1><time class="has-text-grey" datetime="2021-06-08T01:40:00.000Z">2021-06-08</time><article class="mt-2 post-content"><img src="/assets/CyberForensics/bannerftk.jpg" alt="image1" height="400" width="900"/>
<caption>Image taken from <a target="_blank" rel="noopener" href="https://147146-880759-raikfcquaxqncofqfm.stackpathdns.com/wp-content/uploads/2019/07/computer-forensics-classes-in-dubai.jpg">here</a></caption>

<hr>
<p>In this blog I am going to show the interface of FTK Imager tool and talk about various files of NTFS, a widely used tool in terms of Cyber Forensics, and also why I<br>like this tool is because it has so many features and yet it is a free tool. If you don’t have FTK Imager tool then you can download it<br>from this <a target="_blank" rel="noopener" href="https://marketing.accessdata.com/l/46432/2020-09-24/8l45td">link</a>. </p>
<p><img src="/assets/CyberForensics/ftkhome.png" alt="hack"><br><br></p>
<p>This is the home screen of ftk imager. In this you can do the following:</p>
<ol>
<li>Add evidence item</li>
<li>Create image of RAM</li>
<li>Create image of DISK</li>
<li>Various options of image available</li>
<li>Read an evidence item cluster by cluster</li>
<li>Search for suspecious keyword in evidence item</li>
</ol>
<p>and the list goes on and on. That’s why it is a vast and helpful tool in forensics.<br></p>
<h1 id="1-Various-files-present-in-NTFS"><a href="#1-Various-files-present-in-NTFS" class="headerlink" title="1.Various files present in NTFS"></a>1.<u>Various files present in NTFS</u></h1><p>New Technology File System(NTFS) is a widely used file system in Windows operating system. This file system has some default files which it<br>creates for itself to keep a track of all the files in a disk, just like an index keeps all the track of all the pages of a book. Before moving<br>forward let me tell you basic architecture of a disk.</p>
<p><img src="/assets/CyberForensics/disk.jpg" alt="hack"></p>
<caption>Image taken from <a target="_blank" rel="noopener" href="https://www.slashcam.de/images/news/g600/HDD-schema-14071_PIC2-600.jpg">here</a></caption>
<br>

<p>The cluster is a smallest part of a disk of fixed size(512 bytes always) and a cluster is a group of sectors. Generally when you format a disk, you get an option<br>to choose the size of a cluster.<br></p>
<h3 id="1-1Why-is-it-asked"><a href="#1-1Why-is-it-asked" class="headerlink" title="1.1Why is it asked?"></a>1.1<u>Why is it asked?</u></h3><p>It is a good practice to keep the size of a cluster as small as you can, mostly recommended as <strong>4096 bytes</strong>. It is so because sometimes when you create<br>a file for example a text file as <em>test.txt</em>. Most of the times the text file are not so big, or even if they are big then their size wouldn’t be the<br>multiple of the size of cluster(be it 4090 bytes in our case). Say the size of the cluster is 8192 bytes. The size of the file is less than the size of a cluster, the remaining 4102 bytes will be wasted of the cluster(<em>not exactly wasted but it will come in use untill the disk is almost full</em>). This free space is known as <strong>slack space</strong>. Some of the criminals take the advantage of this slack space to store some hidden data in the disk.<br><br><strong>IMPORTANT:</strong> Note the following things in above example:<br></p>
<ol>
<li>Size of sector is 512 bytes(always fixed) </li>
<li>Size of 1 cluster is 8192 bytes i.e. 16 sectors</li>
<li>Size of file is 4090 bytes (Or 7 sectors and 506 bytes) </li>
<li>Actual number of sectors used by file is 8 (7 fully and 8th partially)</li>
<li>Slack space calculated for above file will be 8192-4090=&gt;4102 bytes.</li>
<li>The salck space of 4102 bytes is divided into two parts: <strong>RAM Slack</strong> and <strong>File Slack</strong>.</li>
<li>RAM slack is the number of bytes left in the sector. In this example the 512-506=&gt;6 bytes is the RAM Slack. Why 512? Because the size of 1 sector is 512 bytes and the file is stored in only 7 sectors fully and 506 bytes of 8th sector. So the space which is left in 8th sector i.e. 512-506=&gt;6 bytes is the RAM Slack.</li>
<li>We now know the RAM slack as 6 bytes. Therefore 4102-6=&gt;4096 bytes is the File Slack, i.e 8 sectors. 8 sectors are wasted because of choosing 8192 bytes cluster. If we would have chosen 4096 bytes clusters then <strong>this wastage would have reduced to only 6 bytes RAM slack, and no File Slack would be there at that time</strong>.</li>
<li>RAM Slack is used by RAM as a dump.</li>
</ol>
<br>

<p>I hope you have got from the example used above what is a sector, cluster, slack space and why it is necessary to choose small cluster size!!</p>
<br>

<p>Now one more thing, just an extra knowledge, that if the cluster size is more, then the fragments will be less which would enhance the reading and writing speed and also be feasible in indexing.</p>
<br>
<br>

<p>Remember in the last paragraph I wrote a statement <strong>not exactly wasted but it will come in use untill the disk is almost full</strong>. So how is this thing possible<br>in NTFS file system? we have various hidden files(note that this hidden file is not same as hidden file you create). These hidden files are created by default<br>as soon as the disk is formatted with the NTFS file system, and the name of these files start with <strong>$</strong>.<br><br></p>
<h1 id="2-How-to-see-these-files"><a href="#2-How-to-see-these-files" class="headerlink" title="2.How to see these files?"></a>2.<u>How to see these files?</u></h1><p>Follow the steps to see these files:</p>
<ol>
<li>Go to <b>File > Add Evidence Item</b> <br><img src="/assets/CyberForensics/ftk1.PNG"></li>
<li>Select <b>Logical Drive</b> <br><img src="/assets/CyberForensics/ftk2.PNG"></li>
<li>Select <b>Logical Drive > Next</b></li>
<li>Select your volume, be it C, D, E or any other</li>
<li>Click on <b>Finish</b></li>
</ol>

<br>

<p>The evidence i.e. the logical disk C in my case is added to the <strong>Evidence Tree</strong> panel of the window, and the window will look like the below snap:</p>
<p><img src="/assets/CyberForensics/ftkevidence.PNG" alt="hack"></p>
<br>

<p>Click on + button to expand the tree to get root folder as shown in below snapshot:</p>
<p><img src="/assets/CyberForensics/tree.PNG" alt="hack"></p>
<p>Click on <strong>root</strong> folder directory, and see the changes in <strong>File List</strong> pane of the window. Scroll down to see the files of NTFS file system, responsible to<br>maintain the records regarding the files directories, deleted fies, boot file, even the swap space file can also be seen, the ones marked with <strong>$</strong> symbol in the beginning. These files are the first files to be loaded in the beginning of the disk to map each and everything in the disk. The below snapshot shows such files:</p>
<p><img src="/assets/CyberForensics/NTFSfiles.PNG" alt="hack"></p>
<table>
<thead>
<tr>
<th>File Name</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><strong>$AttrDef</strong></td>
<td>The file contains information related to the usable space in a volume</td>
</tr>
<tr>
<td><strong>$BadClus</strong></td>
<td>Contains information about bad clusters in a disk. You might have seen the notification when you plug in the USB drive about “Scan disk to repair bad clustes”. The PC gets to know about bad clusters from this file only.</td>
</tr>
<tr>
<td><strong>$Bitmap</strong></td>
<td>It stores the flag relatd to the cluster if it is free or not.</td>
</tr>
<tr>
<td><strong>$Boot</strong></td>
<td>As the name suggests, this file contains the necessary information related to the device booting. So that’s why it’s present in the first cluster. Also have the addresses of $MFT and $MFTMirr.</td>
</tr>
<tr>
<td><strong>$LogFile</strong></td>
<td>File contains information about all the changes you do in the file system.</td>
</tr>
<tr>
<td><strong>$MFT</strong></td>
<td>Short form of <strong>Master File Table</strong>. The index of NTFS, having information of all the files that are present in the volume. Each volume has its own MFT, which is mapped to all the files in the volume with the location of cluster, starting point of the file, checksums etc. All this will be discussed in necxt blog.</td>
</tr>
<tr>
<td><strong>$MFTMirr</strong></td>
<td>Mirror file of $MFT first 4 records, like a backup of $MFT, $MFTMirr, $LogFile and $Volume.</td>
</tr>
<tr>
<td><strong>$Secure</strong></td>
<td>Each file has its own ACL in the file system, be it any mp4 file, mp3 file, image file, txt file or anything. The identical ACLs of the files are stored in this $Secure file to reduce the overhead.</td>
</tr>
<tr>
<td><strong>$UpCase</strong></td>
<td>It’s always of 128 KB in size. Having the uppercase letters. Basic purpose of this file is to sort the files according to filenames.</td>
</tr>
<tr>
<td><strong>$Volume</strong></td>
<td>Contains information related to the volume.</td>
</tr>
</tbody></table>
<p>These are the common NTFS files that get loaded first in the clusters to bring in the functionality of file system and maintain the record of each file that gets stored here.<br></p>
<p>Why I discussed this? Because this will come handy in the discussion of next blog where I will show how we can stude the <strong>$MFT</strong> file and access the files from there, even we can restore the deleted file from there.</p>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2021-06-09-Forensics_with_FTK_Image_%20part_2/" title="Forensics with FTK Imager Part 2"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">Previous: Forensics with FTK Imager Part 2</span></a><a class="button is-default" href="/2021-04-13-NBTNS_LLMNR/" title="NBTNS-LLMNR Poisoning"><span class="has-text-weight-semibold">Next: NBTNS-LLMNR Poisoning</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com/vulnfreak"><i class="iconfont icon-twitter"></i></a><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/vulnfreak"><i class="iconfont icon-github"></i></a><!-- Ins--><a title="instagram" target="_blank" rel="noopener nofollow" href="//www.instagram.com/vulnfreak"><i class="iconfont icon-ins"></i></a><!-- RSS--><!-- 知乎--><!-- 领英--><a title="linkedin" target="_blank" rel="noopener nofollow" href="//www.linkedin.com/in/company/71482834/"><i class="iconfont icon-linkedin"></i></a><!-- 脸书--></section><p><span>Copyright ©</span><span> vulnfreak 2021</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script></body></html>