<!DOCTYPE html><html class="appearance-dark" lang="en"><head><meta charset="UTF-8"><title>More on Block Hash</title><meta name="description" content="Infosec Blog"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/img/favicon.png"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="
Image taken from here


In my last blog, I discussed about the concept of block headers, need of block headers, concept of merkle tree, need of merkle root in block header and nonce. In this blog I am going to disuss other headers which were left in last blog and also I will discuss how the block hash can be determined fro the block headers.
1. Block Head.."><meta name="generator" content="Hexo 5.4.0"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">vulnfreak's blog</a></h2></section><h3 class="is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">More on Block Hash</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-Block-Headers"><span class="toc-text">1. Block Headers</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-Block-Version"><span class="toc-text">2. Block Version</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-Previous-Block-Hash"><span class="toc-text">3. Previous Block Hash</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-Timestamp"><span class="toc-text">4. Timestamp</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-Bits"><span class="toc-text">5. Bits</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-Confirming-Block-Hash"><span class="toc-text">6. Confirming Block Hash</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/blockchain"><i class="tag post-item-tag">blockchain</i></a><a href="/tags/integrity"><i class="tag post-item-tag">integrity</i></a><a href="/tags/merkle%20tree"><i class="tag post-item-tag">merkle tree</i></a><a href="/tags/block%20headers"><i class="tag post-item-tag">block headers</i></a><a href="/tags/timestamp"><i class="tag post-item-tag">timestamp</i></a><a href="/tags/version"><i class="tag post-item-tag">version</i></a><a href="/tags/previous%20block%20hash"><i class="tag post-item-tag">previous block hash</i></a><a href="/tags/bits"><i class="tag post-item-tag">bits</i></a><a href="/tags/nonce"><i class="tag post-item-tag">nonce</i></a><a href="/tags/little%20endian"><i class="tag post-item-tag">little endian</i></a><a href="/tags/python%20program"><i class="tag post-item-tag">python program</i></a><a href="/tags/github"><i class="tag post-item-tag">github</i></a></header><h1 class="mt-0 mb-1" id="postTitle">More on Block Hash</h1><time class="has-text-grey" datetime="2021-07-22T01:40:00.000Z">2021-07-22</time><article class="mt-2 post-content"><img src="/assets/Blockchain/banner6.jpg" alt="image1" height="400" width="900"/>
<caption>Image taken from <a target="_blank" rel="noopener" href="https://www.itprotoday.com/sites/itprotoday.com/files/styles/article_featured_retina/public/Hexagons%20connected%20like%20a%20block%20chain.png?itok=2Q2yoP5D">here</a></caption>

<hr>
<p>In my last blog, I discussed about the concept of block headers, need of block headers, concept of merkle tree, need of merkle root in block header and nonce. In this blog I am going to disuss other headers which were left in last blog and also I will discuss how the block hash can be determined fro the block headers.</p>
<h1 id="1-Block-Headers"><a href="#1-Block-Headers" class="headerlink" title="1. Block Headers"></a>1. <u>Block Headers</u></h1><p>To get the block hash the miners have to combine the block headers to get the particular hash starting with some zeroes. Actualy miners don’t have to combine, all this is the backend process of mining software, but you should be knowing this. Following are the block headers which are combined to get a block hash:<br></p>
<ol>
<li><b>Block Version</b></li>
<li><b>Previous Block Hash</b></li>
<li><b>Merkle Root</b></li>
<li><b>Timestamp</b></li>
<li><b>Bits</b></li>
<li><b>Nonce</b></li>
</ol>
<br>

<p>From the above list of headers, I have discussed about Merkle Root and Nonce in last blog. Let’s dig into other headers of bitcoin blockchain.<br></p>
<h1 id="2-Block-Version"><a href="#2-Block-Version" class="headerlink" title="2. Block Version"></a>2. <u>Block Version</u></h1><p>It is nothing but simply the version of the blockchain, started with the version <strong>0x1</strong> when the genesis bock was created. Genesis block is the first block of any blockchain. Currently the version of bitcoin blockchain is <strong>0x20000004</strong>. The snap below shows the version of bitcoin block 2021.<br></p>
<p><img src="/assets/Blockchain/version.png" alt="hack"></p>
<br>

<h1 id="3-Previous-Block-Hash"><a href="#3-Previous-Block-Hash" class="headerlink" title="3. Previous Block Hash"></a>3. <u>Previous Block Hash</u></h1><p>Previous blockhash is the hash of the block which is just before the block for whom the block hash is being calculated. This is used just to create a link between the blocks so that if someone does any changes in some previous block then all the following blocks are afftected, and we come to know easily whose content has been changed. The snap below shows the hash of block 2020, which is the previous block hash of block 2021 in bitcoin.<br></p>
<p><img src="/assets/Blockchain/prevblockhash.png" alt="hack"></p>
<br>

<h1 id="4-Timestamp"><a href="#4-Timestamp" class="headerlink" title="4. Timestamp"></a>4. <u>Timestamp</u></h1><p>Timestamp is just to keep a track that double spending does not occur (as discussed in previous blogs), the time which is actually marked for the block is the epoch time, it is the standard time which is also the time used in Linux Operating System. But for convenience, it is shown in the format of <strong>yyyy-mm-dd hh:mm</strong>  in the block. The snap shown below shows the timestamp of block 2021 in bitcoin.<br></p>
<p><img src="/assets/Blockchain/timestamp.png" alt="hack"></p>
<br>

<h1 id="5-Bits"><a href="#5-Bits" class="headerlink" title="5. Bits"></a>5. <u>Bits</u></h1><p>It is a 4 byte threshold value which specifies the difficulty level, the leading zeroes in target hash depends on this. How 4 byte? you need to convert the decimal value of bits to hexadecimal form. Then it is in the 4 byte format. The below snap shows the decimal value of bits.<br></p>
<p><img src="/assets/Blockchain/bits.png" alt="hack"></p>
<br>

<h1 id="6-Confirming-Block-Hash"><a href="#6-Confirming-Block-Hash" class="headerlink" title="6. Confirming Block Hash"></a>6. <u>Confirming Block Hash</u></h1><p>The bitcoin blockchain is designe in such a way, that finding the hash is difficult, its a heavy load on CPU and GPU while finding a hash which is present in the given range (I discussed the range concept in previous blogs), and it all depends on nonce. You get a particular nonce value and you got your target hash beginning with desired number of zeroes. <strong>But</strong> it is easy to confirm the block, once it is created. Miners confirm the block by using the same headers and which has nonce in it too, in the software which checks whether the hash found was correct or not. I am going to show the working of such software with the help of python code I created. Link for code is <a target="_blank" rel="noopener" href="https://github.com/AnshVaid4/Python/blob/master/blockHashConfirmation.py"><b>https://github.com/AnshVaid4/Python/blob/master/blockHashConfirmation.py</b></a>. The program is for <strong>block 1</strong> of bitcoin blockchain, you can run and verify that the same hash is displayed by the program as that of the hash displayed in <a target="_blank" rel="noopener" href="https://www.blockchain.com/btc/block/1">block 1</a>. Copy and paste to your python IDLE and change the headers accordingly for the respective block whose block hash you want to validate. It will show the block hash if your headers are correct. Following is the explanation about how the block hash is actually created.<br></p>
<p>The alsgorithm is very basic, you need the little endian format of all the headers. In little endian, the binary of the string is converted from right to left format. Let’s see with an example:<br></p>
<p>Following are the four bytes in hexadecimal format:<br><br><strong>0x17 14 96 24</strong> <br><br></p>
<p>When they are converted to little endian, then it becomes:<br><br><strong>0x24 96 14 17</strong> <br><br></p>
<p>Just the reverse, i.e. the 32 bit binary representation will convert from <strong>00010111 00010100 10010110 00100100</strong> to <strong>00100100 10010110 00010100 00010111</strong>.<br></p>
<p>Just have a look on binary digits, the first octet in <strong>00010111 00010100 10010110 00100100</strong> i.e. <strong>00010111</strong> has gone to the end as last octet in <strong>00100100 10010110 00010100 00010111</strong>. Similarly other transitions take place, and to do this I have function <strong>littleEndian(val)</strong> and <strong>hex2Little(val)</strong> in my program whose purpose is to convert to little endian in the same way.<br></p>
<p>The headers are converted to little endian format and then hashed together twice with <strong>SHA256</strong> algorithm. And what you get at the end is the hash of the block.<br><br><strong>IMPORTANT:</strong> Remember this is not called mining, you are not calculating the nonce of the block to get the hash. Infact, you know all the headers and you are just performing mathematical operations on those headers to validate that the headers are correct.<br></p>
<p><strong>IMPORTANT:</strong> Remember that order of combining the little endian values of header which will later be hashed with SHA256 algorithm will always be in same order, i.e. <strong>version + previous block hash + merkle root hash + time + bits + nonce</strong>, if your order changes, then you will get the wrong hash even if your headers are correct. Version is always given in decimal value, and not in hexadecimal value.<br><br>Now if you know the headers of a block, you can easily find its respective hash of the block.<br></p>
<br>

<p>In this blog I have discussed various concepts related to the hash of the block, I have also discussed about the program with which you can easily find the hash of the block and also discussed about the other headers of a block which I left in last blog. In the next blog I will discuss how the cryptography works for the bitcoin, to create a wallet address.</p>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><em></em><a class="button is-default" href="/2021-07-20-BlockHash/" title="Block Hash"><span class="has-text-weight-semibold">Next: Block Hash</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com/vulnfreak"><i class="iconfont icon-twitter"></i></a><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/vulnfreak"><i class="iconfont icon-github"></i></a><!-- Ins--><a title="instagram" target="_blank" rel="noopener nofollow" href="//www.instagram.com/vulnfreak"><i class="iconfont icon-ins"></i></a><!-- RSS--><!-- 知乎--><!-- 领英--><a title="linkedin" target="_blank" rel="noopener nofollow" href="//www.linkedin.com/in/company/71482834/"><i class="iconfont icon-linkedin"></i></a><!-- 脸书--></section><p><span>Copyright ©</span><span> vulnfreak 2021</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script></body></html>